<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ENDING B — 끝나지 않는 밤</title>

  <!-- 폰트 -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css"/>

  <style>
    :root{
      --ink:#f7f0e6;
      --muted:#b8aa9e;
      --border-soft:#ffffff26;
      --bg-main:#050309;
      --bg-card:#120910;
    }

    /* ===== 엔딩별 테마 ===== */
    body.theme-truth{ /* (A엔딩용 – 여기선 안 쓰지만 남겨둠) */
      --accent-main:#ffb36b;
      --accent-strong:#ffd975;
      --accent-pill:#ff7b4b;
      --bg-grad-1:#3b1c22;
      --bg-grad-2:#1a0b10;
    }
    body.theme-loop{  /* ENDING B용 (보라/네온 루프 느낌) */
      --accent-main:#9a84ff;
      --accent-strong:#d2c8ff;
      --accent-pill:#fcf8fa;
      --bg-grad-1:#261c4a;
      --bg-grad-2:#070b20;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Pretendard Variable',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color:var(--ink);
      background:
        radial-gradient(circle at 0% 0%, var(--bg-grad-1) 0, var(--bg-main) 40%, #020104 100%),
        radial-gradient(circle at 110% 120%, var(--bg-grad-2) 0, var(--bg-main) 55%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .ending-frame{
      width:min(1040px, 96vw);
      max-height:92vh;
      border-radius:22px;
      border:1px solid var(--border-soft);
      background:
        radial-gradient(circle at 0% 0%, rgba(180,160,255,.12) 0, transparent 60%),
        radial-gradient(circle at 120% 110%, rgba(120,110,255,.18) 0, transparent 60%),
        linear-gradient(135deg,#0f0b19,#05020c);
      box-shadow:
        0 26px 90px rgba(0,0,0,.9),
        0 0 60px rgba(0,0,0,.7);
      padding:24px 28px 18px;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }

    /* ===== 상단 헤더 ===== */
    .ending-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      margin-bottom:12px;
      gap:16px;
    }

    .brand-block{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .brand-title{
      font-size:clamp(18px,2.2vw,22px);
      letter-spacing:.4em;
      text-indent:.4em;
      font-weight:800;
      color:var(--accent-strong);
      text-shadow:
        0 0 10px rgba(210,200,255,.9),
        0 0 22px rgba(90,80,255,.7);
      white-space:nowrap;
    }
    .brand-sub{
      font-size:.72rem;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:var(--muted);
    }

    .ending-meta-top{
      text-align:right;
      font-size:.75rem;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .ending-meta-top strong{
      display:block;
      margin-top:4px;
      color:var(--accent-strong);
    }

    /* ===== 메인 카드 ===== */
    .ending-card{
      flex:1;
      border-radius:18px;
      border:1px solid #ffffff22;
      background:
        radial-gradient(circle at 0% 0%, rgba(180,170,255,.12) 0, transparent 55%),
        linear-gradient(135deg, #141020, #05040f 70%, #04030b 100%);
      padding:20px 22px 18px;
      display:flex;
      flex-direction:column;
      overflow:auto;
    }

    .kicker{
      font-size:.78rem;
      letter-spacing:.3em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .ending-name{
      margin:4px 0 4px;
      font-size:1.6rem;
      font-weight:700;
      color:var(--accent-main);
    }
    .status-line{
      font-size:.8rem;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:#d6c9bd;
      margin-bottom:16px;
    }

    .summary{
      font-size:.95rem;
      line-height:1.9;
      color:var(--ink);
      margin-bottom:18px;
    }
    .summary p{margin:.3em 0;}
    .summary p.lead{
      font-size:1.02rem;
      color:#fff7fc;
    }

    /* ===== 하단 그리드 ===== */
    .ending-grid{
      display:grid;
      grid-template-columns:1.1fr 1fr;
      gap:14px;
      margin-top:10px;
    }

    .panel{
      border-radius:12px;
      border:1px solid #ffffff1f;
      background:linear-gradient(135deg, rgba(10,8,20,.98), rgba(3,3,10,.98));
      padding:12px 14px 12px;
      font-size:.9rem;
      color:var(--ink);
    }

    .panel h2{
      margin:0 0 6px;
      font-size:.8rem;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:var(--accent-strong);
    }
    .panel ul{
      margin:0;
      padding-left:1.1em;
      list-style:disc;
      color:var(--muted);
      line-height:1.7;
    }

    .panel-wide{
      grid-column:1/-1;
      margin-top:6px;
      background:
        radial-gradient(circle at 0 0, rgba(160,120,255,.16) 0, rgba(5,4,16,1) 55%);
    }
    .panel-wide h2{
      color:var(--accent-pill);
    }

    /* 버튼 / 푸터 */
    .footer{
      margin-top:14px;
      padding-top:10px;
      border-top:1px solid #ffffff1f;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .btn{
      border-radius:999px;
      padding:8px 18px;
      border:1px solid #ffffff33;
      background:transparent;
      color:var(--ink);
      font-size:.85rem;
      letter-spacing:.04em;
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
    }
    .btn.primary{
      background:var(--accent-main);
      border-color:var(--accent-main);
      color:#0e081c;
      font-weight:600;
    }
    .btn span.icon{
      font-size:.9rem;
    }
    .btn:hover{
      border-color:var(--accent-main);
      box-shadow:0 0 18px rgba(170,150,255,.5);
    }

    .footer-note{
      font-size:.78rem;
      color:var(--muted);
    }

    @media (max-width:720px){
      body{padding:14px;}
      .ending-frame{padding:18px 16px;}
      .ending-grid{
        grid-template-columns:1fr;
      }
    }
  </style>
</head>

<!-- ENDING B는 loop 테마 -->
<body class="theme-loop">
  <div class="ending-frame">
    <!-- 상단 -->
    <header class="ending-header">
      <div class="brand-block">
        <div class="brand-title">BANDERSNATCH</div>
        <div class="brand-sub">ENDING ARCHIVE</div>
      </div>
      <div class="ending-meta-top">
        <span>INTERACTIVE NOVEL</span>
        <strong>ENDING B · LOOP</strong>
      </div>
    </header>

    <!-- 메인 카드 -->
    <section class="ending-card">
      <div class="kicker">ENDING B</div>
      <h1 class="ending-name">끝나지 않는 밤</h1>
      <div class="status-line">
        STATUS · UNLOCKED · ROUTE DEPTH : <span id="routeDepth">2</span>
      </div>

      <div class="summary">
        <p class="lead">
          밤은 몇 번이고 끝났다고 말하지만, 화면의 시계와 알림창은 계속해서 같은 시간을 가리킨다.
        </p>
        <p>
          사건은 해결된 것처럼 보이고, 뉴스에서는 더 이상 도살자의 이름을 언급하지 않는다.
          하지만 당신이 되감기 버튼을 누를 때마다, 대사와 장면들은 미세하게 뒤틀린 채
          처음으로 되돌아간다. 이 엔딩에서 주인공은 진실 대신
          <strong>“다시 하기”라는 선택지</strong>에 갇힌다.
        </p>
        <p id="routeIntro">
          초반 선택에서 사건과 거리를 두었고, 두 번째 갈림길에서도 결정적인 순간마다
          한 발 물러서는 쪽을 택했다. 모호한 선택들이 겹쳐지며, 이야기는 결말 대신
          길어진 밤 속을 빙글빙글 돌게 된다.
        </p>
      </div>

      <!-- 2열 패널 -->
      <div class="ending-grid">
        <!-- 왼쪽 : KEY CHOICES -->
        <section class="panel">
          <h2>YOUR KEY CHOICES</h2>
          <ul id="keyChoices">
            <li>첫 선택에서 책이나 단서를 그냥 두고 나가며, 사건과 자신 사이에 안전거리를 두려 했다.</li>
            <li>도살자 관련 기록을 끝까지 읽지 않고, 중간에서 앱을 닫거나 다른 화면으로 도망쳤다.</li>
            <li>클라이맥스 직전, “다시 선택하기”나 “되돌아가기”를 반복적으로 선택해 흐름을 끊어냈다.</li>
          </ul>
        </section>

        <!-- 오른쪽 : 의미 설명 -->
        <section class="panel">
          <h2>WHAT THIS ENDING MEANS</h2>
          <p style="margin:0; color:var(--muted); line-height:1.8;">
            이 루트에서 세계는 사건이 끝났다고 말하지만, 시스템은 당신의 되감기를
            <strong>모두 기억합니다.</strong> 주인공은 분명 일상을 되찾은 것처럼 보이지만,
            화면을 끄거나 뒤로 가기를 누를 때마다 같은 밤으로 다시 불려옵니다.
            이 엔딩은 “안전하게 빠져나온 것 같다”는 착각 뒤에 숨은,
            <em>플레이어의 책임 회피</em>를 보여주는 루프입니다.
          </p>
        </section>

        <!-- 아랫줄 : IF YOU HAD... -->
        <section class="panel panel-wide">
          <h2>IF YOU HAD CHOSEN DIFFERENTLY…</h2>
          <ul id="diffChoices">
            <li>초반에 책을 챙기고, 사건 기사들을 끝까지 읽었다면
              보다 직접적으로 진실을 마주하는 <strong>ENDING A</strong>에 가까워졌을 것입니다.</li>
            <li>마지막 갈림길에서 누군가를 지키기 위해 스스로를 내던지는 선택을 했다면,
              희생을 전제로 한 <strong>ENDING C</strong>로 이어졌을 가능성이 큽니다.</li>
            <li>되감기와 선택 반복 중에 “이게 게임 같다”는 메타적인 선택지만 골라 눌렀다면,
              스스로가 이야기 바깥에 있다는 걸 깨닫는 <strong>ENDING D</strong>로 갈 수 있었을지도 모릅니다.</li>
          </ul>
        </section>
      </div>

      <!-- 버튼 / 푸터 -->
      <footer class="footer">
        <div class="btn-row">
          <button class="btn primary" onclick="location.href='Start.html'">
            <span class="icon">↺</span>
            처음부터 다시 시작
          </button>
          <button class="btn" onclick="location.href='지난선택.html'">
            <span class="icon">☷</span>
            지난 선택 보기
          </button>
          <button class="btn" onclick="location.href='참고.html'">
            <span class="icon">✦</span>
            엔딩 모음집
          </button>
        </div>
        <div class="footer-note">
          이 엔딩을 보면 <strong>ENDING B</strong>가 자동으로 해금되어
          <em>지난 선택 보기</em>와 <em>엔딩 모음집</em> 화면에서 확인할 수 있습니다.
        </div>
      </footer>
    </section>
  </div>

  <script>
    // URL 파라미터 읽기
    function getParam(name){
      const params = new URLSearchParams(location.search);
      return params.get(name);
    }

    document.addEventListener('DOMContentLoaded', () => {
      // ✅ 엔딩 B 해금
      localStorage.setItem('ending:ENDING_B','1');

      // choice 조합에 따라 설명만 살짝 바꾸고 싶으면 path로 넘겨주면 됨
      const path = getParam('path') || 'AB';   // 예: AB 루트에서 루프 엔딩이 나왔다고 가정
      const routeIntro = document.getElementById('routeIntro');

      if(!routeIntro) return;

      switch(path){
        case 'AA':
          routeIntro.textContent =
            '단서를 몇 개는 건드렸지만, 결정적인 순간마다 다시 뒤로 물러섰습니다. ' +
            '진실에 닿을 수 있었던 루트였지만, 당신의 반복된 망설임이 밤을 끝내지 못하게 만들었습니다.';
          break;
        case 'AB':
          routeIntro.textContent =
            '처음부터 사건과 거리를 두었고, 마지막 선택에서도 안전해 보이는 쪽만 골랐습니다. ' +
            '그 결과 이야기는 결말을 내지 못한 채, 같은 밤을 복사해 붙여넣듯 계속 반복됩니다.';
          break;
        case 'BA':
          routeIntro.textContent =
            '중간에 한 번은 깊이 관여하려고 했지만, 곧바로 되돌리거나 다른 선택을 시도했습니다. ' +
            '여러 루트를 뒤섞는 시도 끝에, 시스템은 당신을 “테스트 중인 플레이어”로 분류하고 루프에 가둡니다.';
          break;
        case 'BB':
          routeIntro.textContent =
            '철저하게 아무 책임도 지지 않으려 한 끝에, 당신은 가장 길고 조용한 벌을 받게 됩니다. ' +
            '문제는 끝났다고 믿지만, 화면을 끄는 순간마다 다시 같은 밤의 첫 장면으로 돌아오게 됩니다.';
          break;
        default:
          routeIntro.textContent =
            '여러 갈림길에서 애매한 선택을 반복한 끝에, 이야기는 하나의 결말이 아니라 ' +
            '끝나지 않는야간 재생 목록처럼 변해 버렸습니다.';
      }
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CHOICE 3 — 세 번째 갈림길</title>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css"/>

  <style>
    :root{
      --ink:#f5f0e6;
      --muted:#cfc9bc;
      --accent:#ffe1a6;
      --card-bg:rgba(8,8,10,.92);
      --card-stroke:#ffffff2b;
      --stroke:#ffffff33;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Pretendard Variable',system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
      color:var(--ink);
      background:#000;
      overflow:hidden;
    }

    /* 배경 */
    .bg{
      position:fixed; inset:0;
      background:url('선택3.png') center/cover no-repeat;
      filter:brightness(.9) contrast(1.06);
      transform:scale(1.02);
      transform-origin:center;
    }
    .shade{
      position:fixed; inset:0;
      background:radial-gradient(85% 85% at 50% 18%,rgba(0,0,0,.15),rgba(0,0,0,.92));
      pointer-events:none;
    }

    /* 중앙 레이아웃 */
    .wrap{
      position:relative;
      z-index:1;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:22vh 16px 40px;
    }

    .choice-shell{
      max-width:900px;
      margin:0 auto;
      text-align:center;
    }

    .eyebrow{
      font-size:11px;
      letter-spacing:.20em;
      text-transform:uppercase;
      color:var(--muted);
      margin-bottom:4px;
    }
    .route{
      font-size:12px;
      color:var(--muted);
      margin-bottom:18px;
    }

    h1{
      margin:0 0 10px;
      font-size:clamp(24px,3vw,32px);
      letter-spacing:.02em;
    }

    .question-desc{
      max-width:720px;
      margin:0 auto 22px;
      font-size:14px;
      color:var(--muted);
      line-height:1.8;
    }

    .underline{
      width:260px;
      max-width:60%;
      height:2px;
      margin:0 auto 32px;
      border-radius:999px;
      background:linear-gradient(90deg,transparent,rgba(255,225,166,.85),transparent);
    }

    /* 선택 영역 */
    .choice-area{
      max-width:900px;
      margin:0 auto;
    }

    .timer{
      width:100%;
      max-width:640px;
      height:6px;
      margin:0 auto 14px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.7);
      background:rgba(0,0,0,.75);
      overflow:hidden;
    }
    .timer-fill{
      height:100%;
      transform-origin:left;
      background:linear-gradient(90deg,#ffe1a6,#ffcf78);
      animation:shrink 10s linear forwards;
    }
    @keyframes shrink{
      from{transform:scaleX(1)}
      to{transform:scaleX(0)}
    }

    .choice-row{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      max-width:900px;
      margin:0 auto;
    }

    .choice-card{
      position:relative;
      text-align:left;
      padding:14px 16px 16px;
      border-radius:10px;
      border:1px solid var(--card-stroke);
      background:var(--card-bg);
      box-shadow:0 14px 40px rgba(0,0,0,.65);
      cursor:pointer;
      transition:.18s ease;
    }
    .choice-card.primary{
      border-color:rgba(255,225,166,.95);
      box-shadow:0 0 0 1px #000 inset,0 0 26px rgba(255,225,166,.38);
      background:radial-gradient(circle at 0 0,rgba(255,225,166,.14),rgba(8,8,10,.96));
    }
    .choice-label{
      display:inline-block;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted);
      margin-bottom:4px;
    }
    .choice-title{
      margin:0 0 6px;
      font-size:15px;
      font-weight:600;
    }
    .choice-body{
      margin:0;
      font-size:13px;
      color:var(--muted);
      line-height:1.6;
    }

    .choice-card:hover{
      transform:translateY(-2px);
      box-shadow:0 18px 46px rgba(0,0,0,.8);
      border-color:rgba(255,225,166,.8);
    }

    .choice-card.active{
      outline:2px solid var(--accent);
      outline-offset:2px;
    }

    .footnote{
      margin:16px auto 0;
      max-width:720px;
      font-size:11px;
      color:#aca190;
    }

    @media (max-width:900px){
      .wrap{
        padding:16vh 14px 28px;
      }
      .choice-row{
        grid-template-columns:1fr;
      }
    }
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="shade" aria-hidden="true"></div>

  <div class="wrap">
    <div class="choice-shell">
      <div class="eyebrow" id="eyebrow">CHOICE 3 · 세 번째 갈림길</div>
      <div class="route" id="routeLabel">현재 루트 : -</div>

      <h1>언제 이 밤을 멈출 것인가?</h1>

      <!-- 설명 문단: 선택지 바로 위쪽에 중앙 정렬 -->
      <p class="question-desc">
        지금까지의 클릭과 스크롤이 하나의 긴 기록으로 쌓여 있다.  
        이제 남은 선택지는 두 가지뿐이다. 이 이야기를 더 깊이 따라가 마지막 조각까지 맞춰 보거나,
        오늘 밤을 여기서 끊고 다시 평범한 시간으로 돌아가거나.
      </p>

      <div class="underline"></div>
    </div>

    <section class="choice-area">
      <div class="timer">
        <div class="timer-fill" id="timerFill"></div>
      </div>

      <div class="choice-row">
        <!-- A 선택 -->
        <button class="choice-card primary" data-branch="A">
          <div class="choice-label">선택 A</div>
          <h2 class="choice-title">끝까지 파고들기</h2>
          <p class="choice-body">
            남은 기사와 기록, 인터뷰와 영상까지 모두 훑어본다.
            화면 밖으로 나가더라도 머릿속에서는 계속 이 사건의 타임라인을 정리하게 될 것이다.
          </p>
        </button>

        <!-- B 선택 -->
        <button class="choice-card" data-branch="B">
          <div class="choice-label">선택 B</div>
          <h2 class="choice-title">오늘 선에서 끊어두기</h2>
          <p class="choice-body">
            탭을 정리하고 기기를 끈다. 모든 것을 이해하지 못한 채로 남더라도,
            이 밤을 또 하나의 루프로 만들지 않겠다고 마음속으로 선을 그어 둔다.
          </p>
        </button>
      </div>

      <p class="footnote">
        ※ 데모에서는 어떤 선택을 눌러도 다음 SCENE 3으로 이어지지만,<br />
        실제 작품에서는 이 지점의 선택이 도달하는 엔딩을 크게 바꿔 놓습니다.
      </p>
    </section>
  </div>

  <script>
    // 현재까지의 path (예: "AA", "AB", "BA", "BB")
    const params   = new URLSearchParams(location.search);
    const basePath = params.get('path') || '';

    // 루트 라벨 처리
    const routeLabel = document.getElementById('routeLabel');
    let group = '혼합 루트';
    if (basePath.startsWith('A')) group = 'A 계열';
    else if (basePath.startsWith('B')) group = 'B 계열';
    routeLabel.textContent = '현재 루트 : ' + group;

    // 선택 카드들
    const cards = document.querySelectorAll('.choice-card');
    let activeIndex = 0;
    cards[activeIndex].classList.add('active');

    function goNext(branch){
      const nextPath = (basePath || '') + branch;       // 예: "AA" + "B" = "AAB"
      location.href = 'scene3.html?path=' + encodeURIComponent(nextPath);
    }

    // 클릭 이벤트
    cards.forEach((card,idx)=>{
      card.addEventListener('click', ()=>{
        activeIndex = idx;
        cards.forEach(c=>c.classList.remove('active'));
        card.classList.add('active');
        goNext(card.dataset.branch || 'A');
      });
    });
    // 키보드 ← → Enter
    window.addEventListener('keydown', (e)=>{
      const tag = (e.target.tagName||'').toLowerCase();
      const typing = (tag === 'input' || tag === 'textarea' || e.target.isContentEditable);
      if (typing) return;

      if (e.key === 'ArrowLeft'){
        e.preventDefault();
        activeIndex = 0;
        cards.forEach(c=>c.classList.remove('active'));
        cards[0].classList.add('active');
      } else if (e.key === 'ArrowRight'){
        e.preventDefault();
        activeIndex = 1;
        cards.forEach(c=>c.classList.remove('active'));
        cards[1].classList.add('active');
      } else if (e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        const card = cards[activeIndex] || cards[0];
        goNext(card.dataset.branch || 'A');
      }
    });

    // 10초 지나면 기본 선택(A) 자동 진행
    setTimeout(()=>{ goNext('A'); }, 10000);
  </script>
</body>
</html>
